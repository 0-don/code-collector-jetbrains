<idea-plugin>
    <id>don.codecollector</id>
    <name>Code Collector</name>
    <vendor email="don.cryptus@gmail.com" url="https://github.com/0-don">0-don</vendor>

    <description><![CDATA[
    <p><strong>Effortlessly extract and format your Java/Kotlin codebase for AI assistants.</strong></p>

    <h3>Features</h3>
    <ul>
      <li><strong>Smart Code Collection</strong>: Automatically gathers Java and Kotlin source files with dependency resolution</li>
      <li><strong>Two Collection Modes</strong>:
        <ul>
          <li>Collect from selected files/folders via right-click menu</li>
          <li>Collect entire project codebase with one action</li>
        </ul>
      </li>
      <li><strong>AI-Ready Formatting</strong>: Outputs code with file paths and line numbers for optimal AI context</li>
      <li><strong>Intelligent Filtering</strong>: Excludes build outputs, generated sources, and external libraries</li>
      <li><strong>Configurable Ignore Patterns</strong>: Customize which files to exclude (build/, target/, .git/, etc.)</li>
      <li><strong>One-Click Copy</strong>: Formatted output automatically copied to clipboard</li>
    </ul>

    <h3>Perfect For</h3>
    <ul>
      <li>Sharing code context with AI assistants (ChatGPT, Claude, etc.)</li>
      <li>Code reviews and architecture discussions</li>
      <li>Getting AI help with refactoring and debugging</li>
    </ul>

    <h3>How It Works</h3>
    <p>Simply right-click on files/folders or use the "Collect All Code" action. The plugin formats your code like:</p>
    <pre>// src/main/kotlin/MyClass.kt (L1-L50)
    [your code here]</pre>

    <p>All output is automatically copied to your clipboard, ready to paste into your AI assistant.</p>
    ]]></description>

    <change-notes><![CDATA[
        <ul>
            <li>Initial release</li>
            <li>Smart import analysis for Java/Kotlin</li>
            <li>AI-optimized code context collection</li>
            <li>Configurable ignore patterns</li>
        </ul>
    ]]></change-notes>

    <!-- Core dependencies -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>
    <depends>org.jetbrains.kotlin</depends>

    <!-- K2 compatibility declaration -->
    <extensions defaultExtensionNs="org.jetbrains.kotlin">
        <supportsKotlinPluginMode supportsK2="true"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij">
        <notificationGroup id="Code Collector" displayType="BALLOON"/>
        <projectConfigurable
                parentId="tools"
                instance="don.codecollector.settings.CodeCollectorConfigurable"
                id="don.codecollector.settings"
                displayName="Code Collector"/>
    </extensions>

    <actions>
        <action id="don.codecollector.gatherImports"
                class="don.codecollector.actions.CodeCollectAction"
                text="Code Collect"
                description="Collect code context based on imports">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="before"
                          relative-to-action="CutCopyPasteGroup"/>
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="$Copy"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift G"/>
        </action>

        <action id="don.codecollector.collectAll"
                class="don.codecollector.actions.CodeCollectAllAction"
                text="Code Collect All"
                description="Collect all project code">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="after"
                          relative-to-action="don.codecollector.gatherImports"/>
        </action>
    </actions>
</idea-plugin>