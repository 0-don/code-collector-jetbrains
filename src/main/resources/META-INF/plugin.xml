<idea-plugin>
    <id>don.codecollector</id>
    <name>Code Collector</name>
    <vendor email="don.cryptus@gmail.com" url="https://github.com/yourusername">0-don</vendor>
    <version>1.0.0</version>

    <description><![CDATA[
   <html>
       <body>
           <p>Gather code context for AI assistance by analyzing imports and collecting related Java/Kotlin files.</p>

           <h3>Features:</h3>
           <ul>
               <li><strong>Smart Import Analysis:</strong> Follows import chains to collect all related local files</li>
               <li><strong>Java & Kotlin Support:</strong> Handles both languages seamlessly</li>
               <li><strong>AI-Optimized Output:</strong> Line numbers and file headers for easy AI consumption</li>
               <li><strong>K2 Mode Compatible:</strong> Works with both K1 and K2 Kotlin compiler modes</li>
               <li><strong>Configurable Ignore Patterns:</strong> Customize which files to exclude when collecting all code</li>
           </ul>

           <h3>Usage:</h3>
           <ul>
               <li><strong>Code Collect:</strong> Right-click on file(s) or use <code>Ctrl+Shift+G</code> to collect import-based context</li>
               <li><strong>Code Collect All:</strong> Right-click in project explorer to collect entire codebase</li>
           </ul>

           <p><em>Configure ignore patterns in Settings → Tools → Code Collector</em></p>
       </body>
   </html>
   ]]></description>

    <change-notes><![CDATA[
        <ul>
            <li>Initial release</li>
            <li>Smart import analysis for Java/Kotlin</li>
            <li>AI-optimized code context collection</li>
            <li>Configurable ignore patterns</li>
        </ul>
    ]]></change-notes>

    <!-- Core dependencies -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>
    <depends>org.jetbrains.kotlin</depends>

    <!-- K2 compatibility declaration -->
    <extensions defaultExtensionNs="org.jetbrains.kotlin">
        <supportsKotlinPluginMode supportsK2="true"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij">
        <notificationGroup id="Code Collector" displayType="BALLOON"/>
        <projectConfigurable
                parentId="tools"
                instance="don.codecollector.settings.CodeCollectorConfigurable"
                id="don.codecollector.settings"
                displayName="Code Collector"/>
    </extensions>

    <actions>
        <action id="don.codecollector.gatherImports"
                class="don.codecollector.actions.CodeCollectAction"
                text="Code Collect"
                description="Collect code context based on imports">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="before"
                          relative-to-action="CutCopyPasteGroup"/>
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="$Copy"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift G"/>
        </action>

        <action id="don.codecollector.collectAll"
                class="don.codecollector.actions.CodeCollectAllAction"
                text="Code Collect All"
                description="Collect all project code">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="after"
                          relative-to-action="don.codecollector.gatherImports"/>
        </action>
    </actions>
</idea-plugin>